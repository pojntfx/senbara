{
  "id": "com.pojtinger.felicitas.SenbaraGnomeGomod",
  "runtime": "org.gnome.Platform",
  "runtime-version": "49",
  "sdk": "org.gnome.Sdk",
  "sdk-extensions": ["org.freedesktop.Sdk.Extension.golang"],
  "command": "senbara-gnome-gomod",
  "build-options": {
    "append-path": "/usr/lib/sdk/golang/bin",
    "build-args": ["--filesystem=home"]
  },
  "finish-args": [
    "--socket=wayland",
    "--socket=fallback-x11",
    "--share=ipc",
    "--device=dri"
  ],
  "modules": [
    {
      "name": "senbara-gtk-meson",
      "buildsystem": "meson",
      "sources": [
        { "type": "dir", "path": "../senbara-gtk-meson/" },
        "senbaragtkmeson.go.mod.json"
      ]
    },
    {
      "name": "senbara-gnome-gomod",
      "buildsystem": "simple",
      "build-commands": [
        "mkdir -p vendor && cp modules.txt vendor/modules.txt",
        ". /usr/lib/sdk/golang/enable.sh && export GOBIN=\"/app/bin\" && go generate ./... && go build -o /app/bin/senbara-gnome-gomod -v -mod=vendor -ldflags='-X main.LocaleDir=/app/share/locale' ./src",
        "mkdir -p /app/share/locale && (cd po && find . -name '*.mo' -exec cp --parents {} /app/share/locale/ \\;)"
      ],
      "sources": [
        { "type": "dir", "path": "." },
        {
          "type": "dir",
          "path": "../senbara-gtk-go-meson",
          "dest": "vendor/github.com/pojntfx/senbara/senbara-gtk-go-meson"
        },
        "go.mod.json"
      ]
    }
  ]
}
